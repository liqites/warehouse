<h2>盘点项列表</h2>
<div class="digg_pagination">
  <div class="page_info">
    <%= page_entries_info @inventory_list_items %>
  </div>
  <%= will_paginate @inventory_list_items, :container => false %>
</div>
<%= link_to "导出 详细", export_list_detail_inventory_list_item_path(@inventory_list.id), class: "btn btn-default", data: {confirm: "数据量较大，确定导出?"} %>
<%= link_to "导出 汇总", export_list_total_inventory_list_item_path(@inventory_list.id), class: "btn btn-info", data: {confirm: "数据量较大，确定导出?"} %>
<% if @inventory_list.has_unlocked_pack_item %>
    <%= link_to "锁定包装箱库存", lock_unlock_list_inventory_list_item_path(@inventory_list.id), class: "btn btn-warning", data: {confirm: "确定?"} %>
<% end %>

<% if @inventory_list.has_locked_pack_item %>
    <%= link_to "解锁包装箱库存", lock_unlock_list_inventory_list_item_path(@inventory_list.id), class: "btn btn-warning", data: {confirm: "确定?"} %>
<% end %>

<p id="notice"><%= notice %></p>


<% if @inventory_list.has_un_stored_item %>
    <%= link_to "开始入库", store_list_inventory_list_item_path(@inventory_list.id), class: "btn btn-warning", data: {confirm: "入库后将清空原有的库存记录以新的盘点结果作为库存记录"} %>
<% end %>

<div>
  <form method="get" action="<%= send("search_inventory_list_items_path") %>">
    <div>
      <span>零件号：
        <input type="text" name="inventory_list_item[part_id]" value="<%= @id %>"/>
        <input type="hidden" name="inventory_list_item[part_id_fuzzy]"/>
      </span>
      <input type="submit" value="查 找" class="btn btn-primary"/>
    </div>
  </form>
</div>

<table class="table table-bordered table-striped">
  <thead>
  <tr>
    <th>NO.</th>
    <th>仓库号</th>
    <th>零件号</th>
    <th>FIFO</th>
    <th>FIFO报表</th>
    <th>数量</th>
    <th>原数量</th>
    <th>盘点库位号</th>
    <th>唯一码</th>
    <th>目前仓库</th>
    <th>目前库位</th>
    <th>原材料/半成品/成品标记</th>
    <th>原材料线/非线标记</th>
    <th>需要转换</th>
    <th>创建人</th>
    <th>创建时间</th>
    <th>是否在库存</th>
    <th>是否已锁定包装箱库存</th>
    <th>是否盘点入库</th>
    <th>所属清单</th>
    <th colspan="2">&nbsp;</th>
  </tr>
  </thead>

  <tbody>
  <% @inventory_list_items.each_with_index do |inventory_list_item, i| %>
      <tr>
        <td><%= @page_start+i+1 %></td>
        <td><%= inventory_list_item.whouse_id %></td>
        <% unless inventory_list_item.in_stored? %>
            <td><%= best_in_place inventory_list_item, :part_id, as: :input %></td>
            <td><%= best_in_place inventory_list_item, :fifo_display, as: :input, display_as: :fifo_display %></td>
        <% else %>
            <td><%= inventory_list_item.part_id %></td>
            <td><%= inventory_list_item.fifo_display %></td>
        <% end %>
        <td><%= inventory_list_item.fifo_export_display %></td>
        <% unless inventory_list_item.in_stored? %>
            <td><%= best_in_place inventory_list_item, :qty, as: :input %></td>
            <td><%= best_in_place inventory_list_item, :origin_qty, as: :input %></td>
            <td><%= best_in_place inventory_list_item, :position, as: :input %></td>
        <% else %>
            <td><%= inventory_list_item.qty %></td>
            <td><%= inventory_list_item.origin_qty %></td>
            <td><%= inventory_list_item.position %></td>
        <% end %>
        <td><%= inventory_list_item.package_id %></td>
        <td><%= inventory_list_item.current_whouse %></td>
        <td><%= inventory_list_item.current_position %></td>
        <% unless inventory_list_item.in_stored? %>
            <td><%= best_in_place inventory_list_item, :part_form_mark, as: :input %></td>
            <td><%= best_in_place inventory_list_item, :part_wire_mark, as: :input %></td>
        <% else %>
            <td><%= inventory_list_item.part_form_mark %></td>
            <td><%= inventory_list_item.part_wire_mark %></td>
        <% end %>
        <td><%= inventory_list_item.need_convert_display %></td>
        <td><%= inventory_list_item.user_id %></td>
        <td><%= inventory_list_item.created_at.localtime %></td>
        <td><%= inventory_list_item.in_store_display %></td>
        <td><%= inventory_list_item.locked_display %></td>
        <td><%= inventory_list_item.in_stored_display %></td>
        <td><%= inventory_list_item.inventory_list.name %></td>
        <td><%= link_to 'Show', inventory_list_item %></td>
        <td>
          <% if current_user.admin? %>
              <%= link_to '删除', inventory_list_item, method: :delete, data: {confirm: '确定删除?'} %>
          <% end %>
        </td>
      </tr>
  <% end %>
  </tbody>
</table>

<br>
<div class="digg_pagination">
  <%= will_paginate @inventory_list_items, :container => false %>
</div>
<%= link_to '返回', inventory_lists_path, :class => "btn btn-default btn-lg" %>
